<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
  <head>
    <meta charset="utf-8" />
    <title>Welcome to users</title>
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"
      integrity="sha384-Gn5384xqQ1aoWXA+058RXPxPg6fy4IWvTNh0E263XmFcJlSAwiGgFAW/dAiS6JXm"
      crossorigin="anonymous"
    />
  </head>
  <body>
    <!-- navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-dark">
      <a class="navbar-brand" href="/">SICOMPUCLINIC</a>
      <div class="collapse navbar-collapse" id="navbarSupportedContent">
        <ul class="navbar-nav mr-auto">
          <li class="nav-item active">
            <a class="nav-link" href="/">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/">Cliente</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/listarUsuarios"
              >Usuarios <span class="sr-only">(current)</span></a
            >
          </li>
          <li class="nav-item">
            <a class="nav-link" href="/info">Acerca de nosotros</a>
          </li>
        </ul>
      </div>
    </nav>

    <br />
    <div class="container">
      <div class="row">
        <div class="col-lg-6 col-md-6 container justify-center card py-4">
          <h1 class="text-center">Registrar usuarios</h1>
          <div class="card-body">
            <form id="myForm">
              <div class="form-group">
                <label>Nombre Completo: </label
                ><input
                  type="text"
                  name="name"
                  class="form-control"
                  placeholder="Digite su nombre completo"
                  minlength="9"
                  maxlength="40"
                  required
                />
              </div>
              <div class="form-group">
                <label>Correo Electronico: </label
                ><input
                  type="text"
                  name="email"
                  class="form-control"
                  placeholder="Digite su correo"
                  pattern="[a-z0-9._%+-]+@[a-z0-9.-]+\.[a-z]{2,4}$"
                  required
                />
              </div>
              <div class="form-group">
                <label>Telefono: </label
                ><input
                  type="text"
                  name="phone"
                  class="form-control"
                  pattern="[0-9]+"
                  placeholder="Digite su Telefono"
                  minlength="10"
                  maxlenght="11"
                  required
                />
              </div>
              <div class="form-group">
                <label>Contraseña: </label
                ><input
                  id="password"
                  type="password"
                  name="password"
                  class="form-control"
                  placeholder="Digite su Contraseña"
                  required
                />
              </div>
              <!-- boton de guardar-->
              <div class="box-footer">
                <button
                  class="btn btn-success w-100"
                  onclick="submitForm(event)"
                >
                  Guardar
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <script>
      function submitForm(event) {
        event.preventDefault(); // Prevenir el envío del formulario por defecto

        // Obtener los valores del formulario
        var form = document.getElementById("myForm");
        var name = form.elements.name.value;
        var email = form.elements.email.value;
        var phone = form.elements.phone.value;
        var password = form.elements.password.value;

        // Crear un objeto JSON con los valores del formulario
        var data = {
          name: name,
          email: email,
          phone: phone,
          password: password,
        };

        // Enviar los datos como JSON utilizando fetch API
        fetch("http://localhost:9098/users", {
          method: "POST",
          headers: {
            "Content-Type": "application/json",
          },
          body: JSON.stringify(data),
        })
          .then((response) => response.json())
          .then((data) => {
            // Manejar la respuesta del servidor
            console.log(data);
            // ...
          })
          .finally(() => window.location.assign("/listarUsuarios"))
          .catch((error) => {
            // Manejar errores
            console.error(error);
            // ...
          });
      }
    </script>
  </body>
</html>
